# 第二章 第六节 对象基础

## 对象是啥

对象就是`Object` (这个词的出镜率还挺高的)，对象的标志性特征是它拥有属性，你可以用`.`来访问它的属性，属性可以是任何值，例如说数字，字符串，或者另一个对象。

也许你对这个描述感到熟悉，是的实际上你已经接触过对象了，我们之前讲过`math`对象，数组也是一种对象（不过数字和字符串的情况略有不同，后面会详细讲解它们）

```js
[].length // 0 数组拥有成员length，表示它的长度
```

### 对象的声明和访问

如果你想自己声明一个对象，可以使用对象字面量`{}`，使用`{}`声明的对象是空的，里面什么都没有，因此如果你访问某个属性，会返回`undefined`，如果你需要设置一些初始的属性，可以使用这种语法`{ a: 1 }`，随后你就可以访问属性`a`了

```js
var obj1 = {};
obj1.a // undefined
var obj2 = { a: 1 };
obj2.a // 1
```

特别的，你可以用引号包裹属性名，以声明一些奇怪的属性名，例如说

```js
var obj3 = {
    "a/2": 1,
}
obj3.a/2 // 好像有什么不对劲的地方
```

如果你的属性名里包含了奇怪的字符，就无法直接用`.`来访问了，js提供了另外一种语法来访问对象的属性——使用下标运算符`[]`，特别的，你可以传入一个变量（就像数组那样），这提高了访问的自由度

```js
obj3["a/2"] // 1

var name = "a/2";
obj3[name];
```

如果你希望在声明时就用变量来指定属性名，可以使用`[]`包裹属性名，当然，也可以在里面使用字符串或者表达式

```js
var name = "a/2";
var obj4 = {
    ["a/1"]: 1,
    [name]: 2,
    ["a/"+"3"]: 3,
}
```

### 遍历对象属性

可以使用`for in`语句来遍历对象的所有属性，就像下面这样

```js
for (var i in { a: 1 }) {
    console.log(i, a[i]);
}
// "a" 1
```

特别的，`in` 本身还是一个运算符，你可以用它来判断对象是否拥有某个属性

```js
"a" in { a: 1 } // true
```

> 注意这个运算符优先级比`!`低，因此你需要使用`!`时，要写成`!("a" in { a: 1 } )`而不是`!"a" in { a: 1 }`

## 值类型和引用类型

在上一节中我们提到不要用`Array.fill`来创建二维数组，这节课我们会详细讲解其原因。实际上，js的数据类型分为值类型和引用类型，我们之前接触过的字符串，数字，布尔值，都是值类型，而函数和对象则是引用类型。值类型的特征是，当它被赋值给另外一个变量之后，会拷贝一份新的值，例如说：

```js
var a = "5";
var b = a;
a = "10";
console.log(b); // "5"
```

这是非常符合直觉的——但是悲伤的故事是，这个对于引用类型则部分不成立

```js
var a = [ 1 ];
var b = a;
a[0] = 2;
console.log(b[0]); // 2 （震撼一万年

a = [ 3 ];
console.log(b[0]); // 2
```

这个现象和`引用类型`，这个名称有关，实际上，引用类型持有的并不是对象本身，而是对对象的引用，因此将对象赋值给另外一个变量的时候，两个变量持有了对同一个对象的引用，因此对一个变量的修改会影响另外一个，因此我们可以这么理解上面这个过程

```js
var a = [ 1 ]; // 创建了一个数组 arr1 = [ 1 ], 这里我们用ref(x)来代表指向x的引用，即 a = ref(arr1)
var b = a; // 将a持有的引用拷贝一份给b，即 b = ref(arr1)
a[0] = 2; // 修改arr1 为 [ 2 ]
console.log(b[0]); // b 引用的也是 arr1 , 所以也同样变化了

a = [ 3 ]; // 创建了一个数组 arr2 = [ 3 ], a = ref(arr2)
console.log(b[0]); // 引用本身是值类型，所以 b 还是指向 arr1，因此不会跟着变化
```

## 对象的常见方法

### 遍历对象属性 Object.keys Object.values Object.entries

用`for in`遍历对象属性已经足够应付常见场景，不过，js还提供了一组用于和函数式api结合的方法

你可以使用`Object.keys`获取一个对象的所有属性名称组成的数组（`key`在这里翻译为键（来点键厨），有时候对象的属性名也被称为键名

```js
Object.keys({ a: 1 }) // [ "a" ]
```

`Object.values` 对应的可以获取一个对象的所有属性值称组成的数组

```js
Object.values({ a: 1 }) // [ 1 ]
```

随后js还提供了二合一的`Object.entries`，能获取由`[属性名，属性值]`对构成的数组

```js
Object.entries({ a: 1 }) // [ [ "a", 1 ] ]
```

### 构造对象 Object.fromEntries

`Object.fromEntries`是`Object.entries`的逆运算

```js
Object.fromEntries([ [ "a", 1 ] ]) // { a: 1 }
```

### 对象赋值 Object.assign

`Object.assign(target, ...source)` 允许将一个或多个对象的属性赋值到目标对象上，例如这样

```js
Object.assign({ a: 1 }, { a: 2 }) // { a: 2 }
Object.assign({ a: 1 }, { b: 1 }, { a: 2 }) // { a: 2, b: 1 }
```

>一种编程技巧是，如果想要将两个对象合成为一个，并且不改变两个对象本身，可以用一个空对象作为目标
>```js
>var obj1 = { a: 1 };
>var obj2 = { a: 2 };
>Object.assign({}, obj1, obj2) // { a: 2 }
>```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)

## 对象的用法

js中的对象实际上是传统编程语言中`结构体`和`字典`的混合，因此一种用法是声明结构化的数据，每个属性代表不同的概念

```js
var user = {
    id: 1188,
    name: "老黄鸡",
}
console.log(user.name + "NB!") // 你知道我要说什么
```

而另外一种用法是作为字典，每个属性的值都是类似的东西

```js
var users = {
    ["1188"]: "老黄鸡",
    ["3387"]: "我是小姑娘",
}
users["3387"] = "伯伯";
```
