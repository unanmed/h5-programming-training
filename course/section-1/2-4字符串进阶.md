# 第二章 第四节 字符串进阶

和数字一样，这是第二次细讲

## 字符串的形式

字符串有两种形式，一种用单引号包裹，另一种用双引号包裹，在js中，这两者没有区别

注意事项：在单引号包裹的字符串中不能使用单引号，如需使用请用`\'`，双引号同理

## 字符串拼接

将两个字符串直接用`+`连接起来即可实现字符串拼接

```js
console.log('hello ' + 'world'); // 输出hello world
```

## 字符串比较

特别的，字符串之间可以比较大小，比较的规则被称为字典序——在一本字典中以`a`开头的单词总在`b`开头的单词之前，因此你可以期望

```js
"a" < "abandon" // true
"A" < "B" // true
```

不难理解

```js
"0" < "5" // true
```

不过，对于其他情况，比较的规则会相对复杂，实际上，字符串中的每个字符在内部被表示为一个数字，大小关系是按照这个数字而定的

一些常见字符的编号可以参见[ascii编码](https://baike.baidu.com/item/ASCII/309296)，中文字符一般不会涉及比较，不需要了解

太长不看版: 记住
```js
" " < "0" // 空格小于数字
"9" < "A" // 数字小于大写字母
"Z" < "a" // 大写字母小于小写字母
```
即可

## parseInt & parseFloat

在js中，有两个内置方法可以帮助我们将字符串转化为数字——`parseInt`和`parseFloat`

这两个方法在使用时，要求必须以数字开头，否则会返回`NaN`。在`parseInt`中，会将字符串中第一个非数字字符前的数字转化为数字型，在`parseFloat`中，会将字符串中第一个不是数字或`.` 或 第二个`.`之前的字符转换为浮点型数字，如果不是浮点型，则会返回整型数字。科学计数法无法正确转化

```js
parseInt('12345啦啦啦'); // 12345
parseInt('啦啦啦12345'); // NaN
parseFloat('123.456啦啦啦'); // 123.456
parseFloat('12.34.56'); // 12.34
```

注意事项：如果传入的值不是`string`，则会先进行`toString()`操作再进行`parse`，如果传入数字，则有可能转化为科学计数法形式而导致输出错误

## 字符串与数字混合运算

在js中，最奇妙的feature之一就是字符串与数字混合运算了。在计算时，会按照运算优先级逐步运算，当遇到字符串时，如果碰到`- * / %`，js会尝试`parseFloat`，然后再进行运算，如果遇到`+`，js会尝试将数字`toString()`，再进行字符串拼接。因此，在进行字符串和数字的混合运算时，一定要加括号

以上内容是隐式转换的一部分）

示例：

```js
'1' + 1; // '11'
1 - '1'; // 0
1 * '1'; // 1
4 * 'a'; // NaN
'b' + 2 * 3; // 'b6'
```

## 获得字符串的长度

我们可以使用`string.length`获取字符串的长度

```js
''.length; // 0
'1234567890'.length; // 10
```

## 获取字符串的某一项

我们可以使用`string[n]`来获取字符串的第`n+1`个字符

```js
'123456'[1]; // 2
'abcdefg'[4]; // e
```

## 字符串迭代

我们可以使用`for 循环`迭代字符串

```js
var str = '123467890';
for (var i = 0; i < str.length; i++) console.log(str[i]);
```

这样，我们就可以输出字符串的每一项了

## 三 布尔值

就是 `true or false`

### 注意事项

1. 不要与数字混合运算，不然`true`会转化成1，`false`会转化成0
2. 与字符串运算时会转化成字符串型

## 字符串方法

你可以通过在字符串后面加`.`的方式调用其内置方法，对于字符串变量，这个操作同样有效

### 操作字符编码 codePointAt String.fromCodePoint

`codePointAt(x)` 接受一个数字参数`i`，返回第i个字符的编码

```js
"咕".codePointAt(0) // 21653
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt);

反过来，你可以通过`String.fromCodePoint(...codePoints)` 从字符编码创建字符串

```js
String.fromCodePoint(21653) // 咕
```

### 字符串查找 indexOf lastIndexOf includes startsWith endsWith

js提供了`indexOf(str, i)`方法，接受一个或者两个参数，用来搜索在字符串中`str`头一次出现的位置，如果搜索不到则返回`-1`，否则返回`str`开头字符的下标。如果传入了第二个参数`i`，则会从`i`开始向后查找

```js
"114514".indexOf("1"); // 0
"114514".indexOf("9"); // -1

"114514".indexOf("1", 3); // 4
```

js也提供了`lastIndexOf`方法用于查找字符串的最后一次出现，此时第二个参数则意味着字符串的右边界

```js
"114514".lastIndexOf("1"); // 4
"114514".lastIndexOf("9"); // -1

"114514".lastIndexOf("1", 3); // 1
```

如果你仅仅想知道字符串中是否有某个字符串出现，可以使用`includes`方法，这个方法与`indexOf !== -1`实质上相同

```js
"114514".includes("1"); // true
"114514".includes("9"); // false
```

如果你希望知道某个字符串是不是另一个字符串的前缀/后缀，可以使用`startsWith`/`endsWith`方法（你也可以用上面提到的方法来完成等价的效果

```js
"h5mota.com".startsWith("www"); // false
"h5mota.com".endsWith("com"); // true
```

### 字符串截取 substr substring slice

由于历史原因，js提供了三种方法来截取字符串，其中`substr()`已经被弃用，这里不再介绍

`substring(i, j)` 方法接受一个或两个数字参数，并返回原串第`i`个字符到第`j-1`个字符组成的子字符串(不改动原串)，如果不传入`j`，则返回`i`到字符串末尾这样一个后缀

```js
"123".substring(0, 2) // "12"
"123".substring(1) // "23" 
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/substring);

`slice(i, j)`方法类似于`substring`的升级版，允许传入负数，代表倒数的第x个字符串，在某些情况下这非常方便，但是也容易产生错误

```js
"123".slice(0, 2) // "12"
"123".slice(1) // "23" 

"123".slice(-2, -1) // "2"
"123".slice(-1) // "23"
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/slice);

### 大小写转换 toLowerCase toUpperCase

js提供了 `toLowerCase` `toUpperCase` 这一对方法来转换大小写

```js
"CODELAB".toLowerCase() // codelab
"codelab".toUpperCase() // CODELAB
```

### 字符串连接与分割 concat join split

你可以使用`concat`方法来连接多个字符串

```js
"1926".concat("08", "17") // 一个神秘的数字！
```

`join`方法与此类似，但是它是一个用于数组的方法，它接收一个字符串，将整个字符串数组连接起来，并在每两个字符串之间插入传入的字符串

```js
["1926", "08", "17"].join("") // 与上面相同
["1926", "08", "17"].join("x") // 1926x08x17  
```

反过来，js也提供了将字符串分割为数组的方法`split`，它和`join`恰巧是逆运算

```js
"1926x08x17".split("x") // ["1926", "08", "17"]
```

额外的，你可以传入一个数字控制切分的段数，多余的部分会被忽略掉

```js
"1926x08x17".split("x", 1) // [ "1926" ]
```

### 字符串替换 replace replaceAll

本节课最复杂的方法是字符串替换，js提供了`replace(str, replacer)`方法，它可以匹配一个字符串`str`，然后将它替换为`replacer`

```js
"h5mota.com".replace("h5", "h6") // h6mota.com
```

注意，这个操作只会执行一次，也就是说，即使多次找到符合要求的串，只有第一次会被替换

```js
"114514".replace("14", "15") // 115514
```

你也可以传入一个函数而不是要替代的字符串，这个函数会接收三个参数`s`匹配到的字符串，`i`，匹配到的位置，`str`，原字符串，并用返回值代替原值

```js
"h5mota.com".replace("h5", () => "h6") // h6mota.com
"1495".replace("1", (s, i) => i + s); // 01495
"1{%}1".replace("{%}", (s, i, str) => str); // 11{%}11
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replace)

如果想要替换字符串中所有符合要求的串，则要使用`replaceAll`方法

```js
"114514".replaceAll("14", "15") // 115515
"114514".replaceAll("14", () => "15") // 115515
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll)
