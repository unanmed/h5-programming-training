# 第一次答疑&教材修订

> 如果看的是修正的教材(有前言)，可以跳过此节，相关章节已经增加了相应的内容

经过5节课，codelab逐渐完善，教材也需要修正一下相关问题

本次修订将课程内容进行了一定的拆解，从五节课拉长到八节课，并补充了一部分知识和习题

以下将所有的改动列出（作业中列出所有新增的习题）

## arguments

使用 `arguments` 时可以用 `arguments.length` 获取参数的数量

## 2进制和16进制

在特别的情况下，需要使用其他的进制来表达数字（例如说，二进制串可以当成一连串的布尔值使用，而在表示颜色的时候常用16进制字符串），js提供了2进制和16进制的字面量表示方法，你可以使用`0b`/`0B`开头的数字串来表示二进制(b = binary)，用`0x`/`0X`开头的字符串表示16进制串(x = hex)

```js
0b1 + 0b1 === 0b10 // true 典中典之 1+1 = 10 
-0b1 // 负号是加在最前面的
0x7F // = 127
0xFf // 可以混用大小写，但是小心被强迫症打（
```

## 立即执行函数 IIFE

在某些特殊情况下，我们会希望立即执行一个临时的函数，例如说，跳出多层循环：

```js
for (var i = 0; i < x; i++) {
    for (var j = 0; j < x; j++) {
        if (i + j === 10) {
            // 想在这里跳出，但是break只能跳出一层，很尴尬
        }
    }   
}
```

在这种时候，我们可以借助临时函数的`return`语句来解决问题

```js
(function() {
    for (var i = 0; i < x; i++) {
        for (var j = 0; j < x; j++) {
            if (i + j === 10) {
                return i*j; // 直接跳出两层
            }
        }   
    }
})();
```

这种形式被称为立即执行函数，简称`IIFE`，在编写`IIFE`时，声明的函数要用小括号包裹才能执行调用


## 箭头函数

> 截止目前，请不要在样板中使用这一语法，这个语法无法通过压缩

在2015年，js引入了一种新的声明函数的方法`箭头函数`，用于声明临时的，没有名字的函数

箭头函数的语法非常简单: `(参数) => { 函数体 }`，相当于`function (参数) { 函数体 }`

举例子：

```js
var myFunc = (x) => {
    return (y) => {
        return x + y;
    }
}
```

特别的，如果函数体只有一条语句，可以省略大括号，这条语句的值会做为整个函数的返回值

```js
// 改写上面的函数
var myFunc = (x) => {
    return (y) =>  x + y;
}
// 甚至可以这样！
var myFunc = (x) => ((y) => x + y);
```

箭头函数也可以作为`IIFE`，语法如下

```js
(() => {
    console.log("a");
})();
```

特别的，箭头函数中无法使用`arguments`来获取传入参数，从编程风格来说，推荐将所有具名的函数写成`function`形式，而作为参数或者返回值的函数则写成箭头函数形式

## 字符串方法

## 字符串方法

你可以通过在字符串后面加`.`的方式调用其内置方法，对于字符串变量，这个操作同样有效

### 获取字符编码 codePointAt

`codePointAt(x)` 接受一个数字参数`i`，返回第i个字符的编码

```js
"啊".codePointAt(0); // 21834
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt);

### 字符串查找 indexOf lastIndexOf includes startsWith endsWith

js提供了`indexOf(str, i)`方法，接受一个或者两个参数，用来搜索在字符串中`str`头一次出现的位置，如果搜索不到则返回`-1`，否则返回`str`开头字符的下标。如果传入了第二个参数`i`，则会从`i`开始向后查找

```js
"114514".indexOf("1"); // 0
"114514".indexOf("9"); // -1

"114514".indexOf("1", 3); // 4
```

js也提供了`lastIndexOf`方法用于查找字符串的最后一次出现，此时第二个参数则意味着字符串的右边界

```js
"114514".lastIndexOf("1"); // 4
"114514".lastIndexOf("9"); // -1

"114514".lastIndexOf("1", 3); // 1
```

如果你仅仅想知道字符串中是否有某个字符串出现，可以使用`includes`方法，这个方法与`indexOf !== -1`实质上相同

```js
"114514".includes("1"); // true
"114514".includes("9"); // false
```

如果你希望知道某个字符串是不是另一个字符串的前缀/后缀，可以使用`startsWith`/`endsWith`方法（你也可以用上面提到的方法来完成等价的效果

```js
"h5mota.com".startsWith("www"); // false
"h5mota.com".endsWith("com"); // true
```

### 字符串截取 substr substring slice

由于历史原因，js提供了三种方法来截取字符串，其中`substr()`已经被弃用，这里不再介绍

`substring(i, j)` 方法接受一个或两个数字参数，并返回原串第`i`个字符到第`j-1`个字符组成的子字符串(不改动原串)，如果不传入`j`，则返回`i`到字符串末尾这样一个后缀

```js
"123".substring(0, 2) // "12"
"123".substring(1) // "23" 
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/substring);

`slice(i, j)`方法类似于`substring`的升级版，允许传入负数，代表倒数的第x个字符串，在某些情况下这非常方便，但是也容易产生错误

```js
"123".slice(0, 2) // "12"
"123".slice(1) // "23" 

"123".slice(-2, -1) // "2"
"123".slice(-1) // "23"
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/slice);

### 大小写转换 toLowerCase toUpperCase

js提供了 `toLowerCase` `toUpperCase` 这一对方法来转换大小写

```js
"CODELAB".toLowerCase() // codelab
"codelab".toUpperCase() // CODELAB
```

### 字符串连接与分割 concat join split

你可以使用`concat`方法来连接多个字符串

```js
"1926".concat("08", "17") // 一个神秘的数字！
```

`join`方法与此类似，但是它是一个用于数组的方法，它接收一个字符串，将整个字符串数组连接起来，并在每两个字符串之间插入传入的字符串

```js
["1926", "08", "17"].join("") // 与上面相同
["1926", "08", "17"].join("x") // 1926x08x17  
```

反过来，js也提供了将字符串分割为数组的方法`split`，它和`join`恰巧是逆运算

```js
"1926x08x17".split("x") // ["1926", "08", "17"]
```

额外的，你可以传入一个数字控制切分的段数，多余的部分会被忽略掉

```js
"1926x08x17".split("x", 1) // [ "1926" ]
```

### 字符串替换 replace replaceAll

本节课最复杂的方法是字符串替换，js提供了`replace(str, func)`方法，它可以匹配一个字符串`str`，然后执行`func`，将原串中的`str`替换为`func`的返回值，当然，你也可以直接传入要替换的字符串

```js
"h5mota.com".replace("h5", "h6") // h6mota.com
"h5mota.com".replace("h5", () => "h6") // h6mota.com
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replace)

```js
"114514".replaceAll("14", "15") // 115515
"114514".replaceAll("14", () => "15") // 115515
```

更多细节参见[mdn文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll)

## 数组章节重构

将数组章节拆分为两节，并增设了一些习题，以及讲解，推荐全文阅读一次`2-5数组进阶`
