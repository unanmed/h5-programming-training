# 第四章 第一节 了解类型

## 什么是typescript

typescript，简称ts，文件的后缀名为.ts。typescript是javascript的超集，这意味着ts包含js。对于ts，最为重要的显然是type，也就是类型。如果你学过java c c++ c#或其他强类型语言，你对类型一定不会陌生，ts与他们也类似。

官方文档（纯英文，可以训练英语）：https://www.typescriptlang.org/docs/handbook/intro.html

## 安装typescript

运行`npm i -g typescript`即可

## 基础类型

在ts中，基础类型与js一样，包括`string` `number` `boolean` `object` `function` `undefined` `bigint` `symbol`共八种。在写ts时，我们可以明确指定某个变量的类型，如下列代码

```ts
let x: number = 1;
const y: string = 'h5nb';
```

当然，我们大部分情况不需要特别指明变量的类型，因为ts可以进行类型推导，判断变量的类型，使用vscode是也可以直接为我们指明变量类型

```ts
let x = 12345; // 类型推导会得到x的类型为number
const y = 'lhjnb'; // y的类型为string
```

## 联合类型

### 问题所在

如果我们写以下代码

```ts
let x = 1;
x = 'h5nb';
```

那么就会报错，因为number类型的数据无法转变成string类型，不过ts也为我们提供了解决办法。

### 声明联合类型

ts解决这个问题的办法就是联合类型。

```ts
let x: string | number = 1;
x = 'h5nb';
```

这样ts就不会报错了，我们可以随意让x在数字和字符串之间相互转换

## 类型断言

### 新的问题

接着上面的代码，如果我们这么写

```ts
let x: string | number = 1;
x = 'h5nb';
x.split('5');
```

这样就会报错，提示说`number类型不存在split属性`，因为在这时候，x是`number | string`，而ts不知道x到底是number还是string，就会出现如上报错

### 进行类型断言

为了解决这个问题，ts使用了类型断言，即告诉ts`相信我，这个变量的类型就是这个`，从而让ts知道了更精确的类型，有两种写法

```ts
// 写法1，常用写法
x as string; // 注意as的优先级较高，必要时要加括号
// 写法2，不常用写法，一般的教程根本没有这个写法，在有时候甚至会报错，非常不推荐
<string>x;
```

### 使用判断语句

当然，我们还有一种解决办法，用判断语句

```ts
if (typeof x === 'number') { console.log('x is number'); }
else console.log('x is string');
```

这两种方法都是解决以上问题的办法，可以根据情况选择合适的方法

## 字面量类型

### 新的问题

只用`string`或`number`类型时，会发现一个问题，那就是我们无法得知字符串和数字的准确内容，为此，ts为我们提供了字面量类型

### 声明字面量类型

声明字面量类型很简单，如下例

```ts
let x: 'lhj' | 'h5' = 'lhj';
let y: 1 | 2 | 5 = 2;
```

声明方式类似于联合类型，属于可辨识联合的一部分。这样，在之后的代码中，ts就知道了这个变量的准确字面量，从而让类型更为精确

## 类型别名

### 又有新问题

如果我们声明了一个很长的类型，同时又需要频繁使用，那么就会显得很啰嗦，可读性也差，为此，ts为我们提供了类型别名这个东西

### 使用类型别名

```ts
type MyType = 'lhjnb' | 'h5nb' | '鹿神nb' | '艾神nb';
let x: MyType = 'lhjnb';
```

由此可见，`MyType`类似于一个变量，但在代码中并不会执行，只是用作一个类型声明。当然，我们还可以这样使用类型别名

```ts
type MyType1 = 'h5nb';
type MyType2 = 'lhjnb';
type MyType = MyType1 | MyType2;
```

这种方式也是合法的

## 模板字符串

### 叕有新问题

下面我们声明一个非常长的联合类型

```ts
type T = 'lhjnb' | 'h5nb' | '鹿神nb' | '艾神nb' | 'adnb' | '秋橙nb';
```

显然，这些字符串里面都含有`nb`而且都在字符串末尾，这样写就显得很啰嗦，而且会降低可读性，那么，我们就可以使用模板字符串

### 使用模板字符串

与es6中的模板字符串类似，使用`${}`语法，如下例

```ts
type Name = 'lhj' | 'h5' | '鹿神' | '艾神' | 'ad' | '秋橙';
type MyType = `${Name}nb`;
```

这样就会显得清晰明了了

## 运行ts文件

ts无法直接在浏览器上运行，如果我们想要运行的话，需要先进行转译，使用命令`tsc 文件路径`即可转译，然后就可以用浏览器或node运行了。当然，如果想要直接运行ts，可以使用deno，不过我们不讲这种方法，我们会在之后使用脚手架解决这个问题。

不过，一直使用tsc命令转译显得很麻烦，ts为我们提供了一种监听方案，使用`tsc watch 文件路径`，可以在每次保存后自动进行转译